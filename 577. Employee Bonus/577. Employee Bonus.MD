LeetCode 577: Employee Bonus
============================

==============================

Problem Description
----------------


Select all employee's name and bonus whose bonus is less than 1000.

Return the result table in any order.

* * * * *

Table Schema
----------------


### `Employee`

| Column Name | Type | Description |
| --- | --- | --- |
| `empId` | int | The primary key of the table. |
| `name` | varchar | The name of the employee. |
| `supervisor` | int | The ID of the supervisor. |
| `salary` | int | The salary of the employee. |

### `Bonus`

| Column Name | Type | Description |
| --- | --- | --- |
| `empId` | int | The primary key of the table (foreign key to Employee table). |
| `bonus` | int | The bonus amount. |

* * * * *

Example Input
----------------


### `Employee` Table:

| empId | name | supervisor | salary |
| --- | --- | --- | --- |
| 3 | Brad | null | 4000 |
| 1 | John | 3 | 1000 |
| 2 | Dan | 3 | 2000 |
| 4 | Thomas | 3 | 4000 |

### `Bonus` Table:

| empId | bonus |
| --- | --- |
| 2 | 500 |
| 4 | 2000 |

* * * * *

Expected Output
----------------

| name | bonus |
| --- | --- |
| Brad | null |
| John | null |
| Dan | 500 |

Explanation:

-   Brad has no bonus record, so bonus is null

-   John has no bonus record, so bonus is null

-   Dan has bonus 500 which is less than 1000

-   Thomas has bonus 2000 which is ≥ 1000, so excluded

* * * * *

SQL Solution
----------------

```sql

SELECT e.name, b.bonus
FROM Employee e
LEFT JOIN Bonus b ON e.empId = b.empId
WHERE bonus < 1000 OR bonus IS NULL;
```
* * * * *

Query Explanation
----------------


### Step 1: LEFT JOIN to Include All Employees

```sql

FROM Employee e
LEFT JOIN Bonus b ON e.empId = b.empId
```

-   LEFT JOIN ensures we include all employees from the Employee table

-   Employees without bonus records will have NULL values for all Bonus table columns

-   This is crucial because we need to include employees who didn't receive any bonus

### Step 2: WHERE Clause Filtering

```sql

WHERE bonus < 1000 OR bonus IS NULL
```
This WHERE clause has two conditions:

1.  `bonus < 1000`: Includes employees whose bonus is strictly less than 1000

2.  `bonus IS NULL`: Includes employees who have no bonus record at all

The OR operator ensures that if either condition is true, the employee is included.

### Why This Approach Works:

-   Employees with bonus < 1000: They satisfy the first condition (`bonus < 1000`)

-   Employees with no bonus: They satisfy the second condition (`bonus IS NULL`)

-   Employees with bonus ≥ 1000: They don't satisfy either condition and are excluded

### Alternative Solutions:

Using COALESCE:

```sql

SELECT e.name, b.bonus
FROM Employee e
LEFT JOIN Bonus b ON e.empId = b.empId
WHERE COALESCE(b.bonus, 0) < 1000;
```
Using Subquery:

```sql

SELECT e.name, b.bonus
FROM Employee e
LEFT JOIN Bonus b ON e.empId = b.empId
WHERE (b.bonus < 1000 OR b.bonus IS NULL);
```
Key Insight: The LEFT JOIN combined with the `OR` condition in the WHERE clause elegantly handles both scenarios:

-   Employees with small bonuses

-   Employees with no bonus records

This ensures we don't accidentally exclude employees who simply didn't receive any bonus at all.