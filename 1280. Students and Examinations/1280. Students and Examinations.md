LeetCode 1280: Students and Examinations
========================================

==============================

Problem Description
----------------
* * * * *

Write an SQL query to find the number of times each student attended each exam.

Return the result table ordered by `student_id` and `subject_name`.

* * * * *

Table Schema
----------------

### `Students`

| Column Name | Type | Description |
| --- | --- | --- |
| `student_id` | int | The primary key of the table. |
| `student_name` | varchar | The name of the student. |

### `Subjects`

| Column Name | Type | Description |
| --- | --- | --- |
| `subject_name` | varchar | The primary key of the table. |

### `Examinations`

| Column Name | Type | Description |
| --- | --- | --- |
| `student_id` | int | The ID of the student who took the exam. |
| `subject_name` | varchar | The name of the subject exam taken. |

* * * * *

Example Input
----------------
### `Students` Table:

| student_id | student_name |
| --- | --- |
| 1 | Alice |
| 2 | Bob |
| 13 | John |
| 6 | Alex |

### `Subjects` Table:

| subject_name |
| --- |
| Math |
| Physics |
| Programming |

### `Examinations` Table:

| student_id | subject_name |
| --- | --- |
| 1 | Math |
| 1 | Physics |
| 1 | Programming |
| 2 | Programming |
| 1 | Physics |
| 1 | Math |
| 13 | Math |
| 13 | Programming |
| 13 | Physics |
| 2 | Math |
| 1 | Math |

* * * * *

Expected Output
----------------
| student_id | student_name | subject_name | attended_exams |
| --- | --- | --- | --- |
| 1 | Alice | Math | 3 |
| 1 | Alice | Physics | 2 |
| 1 | Alice | Programming | 1 |
| 2 | Bob | Math | 1 |
| 2 | Bob | Physics | 0 |
| 2 | Bob | Programming | 1 |
| 6 | Alex | Math | 0 |
| 6 | Alex | Physics | 0 |
| 6 | Alex | Programming | 0 |
| 13 | John | Math | 1 |
| 13 | John | Physics | 1 |
| 13 | John | Programming | 1 |

* * * * *

SQL Solution
----------------
```sql

SELECT
    s.student_id,
    s.student_name,
    sub.subject_name,
    COUNT(e.subject_name) AS attended_exams
FROM
    Students s
CROSS JOIN
    Subjects sub
LEFT JOIN
    Examinations e
ON
    s.student_id = e.student_id
    AND sub.subject_name = e.subject_name
GROUP BY
    s.student_id, s.student_name, sub.subject_name
ORDER BY
    s.student_id, sub.subject_name;
```
* * * * *

Query Explanation
----------------
### Step 1: Create All Possible Combinations (CROSS JOIN)

```sql

FROM Students s
CROSS JOIN Subjects sub
```
-   CROSS JOIN creates a Cartesian product between Students and Subjects

-   This generates every possible combination of student and subject

-   For example: If there are 4 students and 3 subjects, this creates 4 × 3 = 12 rows

-   This ensures we have a row for every student for every subject, even if they never took that exam

### Step 2: LEFT JOIN with Examinations

```sql

LEFT JOIN Examinations e
ON s.student_id = e.student_id
   AND sub.subject_name = e.subject_name
```
-   LEFT JOIN attaches examination records where they exist

-   The join condition matches both student_id AND subject_name

-   For combinations where a student never took a particular exam, the Examination columns will be NULL

-   This preserves all combinations from the CROSS JOIN

### Step 3: Count Exam Attendances

```sql

COUNT(e.subject_name) AS attended_exams
```
-   COUNT(e.subject_name) counts only non-NULL values from the Examinations table

-   When there's no matching exam record, e.subject_name is NULL and doesn't get counted

-   This gives us 0 for subjects the student never took

-   This gives us the actual count for subjects the student took multiple times

### Step 4: Grouping and Ordering

```sql

GROUP BY s.student_id, s.student_name, sub.subject_name
ORDER BY s.student_id, sub.subject_name
```
-   GROUP BY groups the results by each unique student-subject combination

-   ORDER BY sorts the output by student_id and then by subject_name for readability

### Why This Approach Works:

1.  CROSS JOIN ensures we have the complete matrix of all students × all subjects

2.  LEFT JOIN preserves this complete matrix while attaching exam data where available

3.  COUNT(e.subject_name) correctly handles counting (counts exams when they exist, returns 0 when they don't)

4.  The result shows every student's attendance for every subject, including zeros for unattempted exams

### Alternative Solution (Using Subquery):

```sql

SELECT
    s.student_id,
    s.student_name,
    sub.subject_name,
    (SELECT COUNT(*)
     FROM Examinations e
     WHERE e.student_id = s.student_id
     AND e.subject_name = sub.subject_name) AS attended_exams
FROM
    Students s
CROSS JOIN
    Subjects sub
ORDER BY
    s.student_id, sub.subject_name;
```
Key Insight: The CROSS JOIN is essential for generating the complete combination set, and the LEFT JOIN with COUNT on the joined table's column elegantly handles the counting of exam attendances while preserving zeros for missing combinations.